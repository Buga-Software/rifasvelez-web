---
const { pathname } = new URL(Astro.request.url);
const currentPath = pathname.replace(/\/$/, '') || '/';

const navItems = [
  { href: '/', label: 'Inicio' },
  { href: '/ganadores', label: 'Ganadores' },
  { href: '/sorteos', label: 'Sorteos' },
  { href: '/sevendedor', label: 'Sé vendedor!', special: true }
];
---

<nav class="fixed top-0 lg:top-0 left-0 right-0 lg:left-0 lg:right-0 z-[1000] flex flex-col lg:flex-row lg:items-center justify-between md:px-32 px-12 py-6 bg-white/90 font-bold text-[var(--primary)] shadow-md rounded-b-3xl backdrop-blur-md">
  <div class="flex justify-between">
    <a href="/">
      <img class="h-14" src="/assets/velez.png" alt="Logo de Velez la tradicional de los bugueños">
    </a>
    <button class="lg:hidden" id="toggle">
      <svg class="transition-all duration-300 ease-in-out" id="burguer" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path id="line-top" d="M4 8l16 0" />
        <path id="line-bottom" d="M4 16l16 0" />
      </svg>
      <svg id="x" class="hidden transition-all duration-300 ease-in-out" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M18 6l-12 12" />
        <path d="M6 6l12 12" />
      </svg>
    </button>
  </div>

  <ul id="links" class="max-h-0 overflow-hidden lg:max-h-none transition-all duration-500 ease-in-out lg:flex flex-col lg:flex-row text-center lg:gap-6 space-y-2 lg:space-y-0">
    { navItems.map(({ href, label, special }) => (
      <li class={`rounded-xl transition-colors duration-300 ease-in-out ${currentPath === href 
      ? 'bg-[var(--primary)] text-white' 
      : 'text-[var(--primary)] hover:bg-[var(--primary)]/10 hover:text-[var(--primary)]'
    }`}>
        <!-- solo aplicamos shiny si es special Y no está active -->
        <a class={`px-4 py-2 block ${special && currentPath !== href ? 'shiny-text' : ''}`} href={href}>{label}</a>
      </li>
    ))}
  </ul>
</nav>

<script lang="ts">
toggle?.addEventListener('click', () => {
  links?.classList.toggle('mt-8');
  links?.classList.toggle('max-h-96');
  burguer?.classList.toggle('hidden');
  x?.classList.toggle('hidden');
});
</script>

<style>
  #links li:hover, button:hover {
    cursor: pointer;
  }

  /* Efecto shiny para "Sé vendedor!" */
  .shiny-text {
    position: relative;
    background: linear-gradient(
      90deg,
      var(--primary),
      #ff9f19,
      var(--primary),
      #ff9f19
    );
    background-size: 300% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: shine 3s linear infinite;
  }

  @keyframes shine {
    0% { background-position: 0% center; }
    100% { background-position: 100% center; }
  }
</style>
